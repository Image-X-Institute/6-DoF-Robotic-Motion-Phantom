# Post-processing to align graphically outputs and inputs using RealSense camera: 

MatLab post-processing code: https://github.com/Image-X-Institute/6-DoF-Robotic-Motion-Phantom/tree/cef673f1f90710c32e75c7a5b7019ccfc3025943/Post%20processing 

- 8 lists generated by the input and output data txt files (1D input timestamps, 1D input displacements, 1D (and 6D) acquisition timestamps by RealSense, 1D depth measurements recorded by RealSense, 6D input timestamps, 6D input displacements, 6D depth measurements recorded by RealSense).  

- Initialization of a list of shifts to test and start a loop (for each testing shifts value from the list).  

- For each iteration: 

  - Subtract the testing shift to the output timestamps and get rid of the output values before 0s and after 299.8s (length of the trace). 
  - Shifted output data between 0 and 299.8s are used to interpolate input data. 
  - Calculation of the RMSE between interpolated input data and shifted output data and save that value in a list 
  - Find the minimal RMSE from the RMSE list 
  - The index of the min RMSE gives the index of the optimal shift in the list of shifts initialized at the beginning.  

The difference between the two optimal shifts is the latency of the combined system. 

Once the optimal shift is found, the difference between interpolated input and optimal shifted output can be calculated -> mean, std, 1st et 99th percentile for each test, then for each trace and finally for all the traces.  

